# README

## 文件结构

- 绘图文件
- 建模文件
- 任务说明文件
- 周期汇报
- Ansys
- data
- scripts
  - py端分析器

## 双端分析器执行逻辑

- **在 py 中运行 `py端分析器.py`**

`py端分析器.py` 中包含一个任务队列 `task_queue`，一个任务栈 `task_stack`。任务队列中存放待执行的任务，任务栈中存放已经分析完成的任务。每个任务元素都是由六个数字表示的元组，分别表示六个螺栓参数。

`py端分析器.py`持续循环查找 `"../data/task_queue.txt"` 文件，将该文件消失视为ansys分析完成，此时弹出任务队列中的元素，依次分析同轴度并压入 `ansys_ans` 栈中。将任务队列完成的任务压入任务栈中。

根据任务栈和分析结果栈中的数据，梯度下降获得下一组任务参数，将其压入任务队列中。

将任务队列写入 `"../data/task_queue.txt"` 文件，等待下一次循环。

在等待循环的过程中利用空闲时间完成上一个周期内任务的分析结果绘图等后处理工作。

- **在 Ansys 中运行 `ansys端分析器.py`**

`ansys` 中不指定初始任务，而是持续循环查找 `"../data/task_queue.txt"` 文件，将该文件出现视为py端分析完成，开始执行分析任务。

文件中每一行即为一个单独的任务，为一个元组，包括六个螺栓参数。由于读取每一行为一个字符串，可采用 `task[1:-1]..strip().split(",")` 函数将其转化为元组。

在分析完成后，将每个任务的分析结果写入 `"../data/" + str(task)` 文件中，等待py端读取。**注意，这里没有后缀，本质上就是txt文件**

完成所有分析任务后删除 `"../data/task_queue.txt"` 文件，等待下一次循环。
